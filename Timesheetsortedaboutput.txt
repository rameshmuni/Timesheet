import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.util.Iterator;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class POIforgfgRead {
	
public static void main(String[] args) throws Exception{
        
        FileInputStream inputFile =new FileInputStream("D:\\Data\\Input\\MasterSheet.xlsx");
        XSSFWorkbook workbook=new XSSFWorkbook(inputFile);
        XSSFSheet worksheet =workbook.getSheetAt(0);
        
        XSSFWorkbook formatedWorkbook = new XSSFWorkbook(); 
        XSSFSheet formatedWorksheet = formatedWorkbook.createSheet("Employee Data");
        
        int rowNum = 0;
        for(int i=3; i<=worksheet.getLastRowNum(); i++) {
            Row row =  worksheet.getRow(i);
            if (row != null && row.getCell(0) != null && Cell.CELL_TYPE_BLANK != row.getCell(0).getCellType()){
            	Row formatedRow = formatedWorksheet.createRow(rowNum++);
            	int cellnum = 0;
            	Iterator<Cell> cellIterator = row.cellIterator();
	            while(cellIterator.hasNext()) {
	                Cell celldata = cellIterator.next();
	                Cell cell = formatedRow.createCell(cellnum++);
	                switch(celldata.getCellType()){
	                    case Cell.CELL_TYPE_STRING: cell.setCellValue(celldata.getStringCellValue());
		                    						break;
		                case Cell.CELL_TYPE_NUMERIC: cell.setCellValue(celldata.getNumericCellValue());
		                    						 break;
		                case Cell.CELL_TYPE_BOOLEAN: cell.setCellValue(celldata.getBooleanCellValue());
		                    						 break;
	                }
	            }
            }
        }
        
        inputFile.close();
        
        FileOutputStream outputFile = new FileOutputStream(new File("D:\\update.xlsx"));
        formatedWorkbook.write(outputFile);
        outputFile.close();
    }
}